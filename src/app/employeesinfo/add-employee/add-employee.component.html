<div class="container-fluid">
  <div class="card shadow mb-4">
    <div
      class="card-header d-sm-flex align-items-center justify-content-between mb-2 py-3"
    >
      <h6 class="h4 m-0 text-primary" style="font-weight: 500">
        {{ forUpdate ? "Update Employee Form" : "Add Employee Form" }}
      </h6>
      <a
        routerLink="/employees"
        class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"
        ><i class="fas fa-list fa-sm text-white-50"></i> Show List</a
      >
    </div>

    <div class="card-body py-4" style="position: relative">
      <div
        *ngIf="isLoading; else elseForm"
        style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        "
      >
        <app-loader :title="loadingTitle" />
      </div>
      <ng-template #elseForm>
        <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()" novalidate>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="department_id">Department ID:</label>
                <select
                  formControlName="department_id"
                  class="form-control"
                  required
                >
                  <option value="" disabled selected>
                    Select a Department
                  </option>
                  <option
                    *ngFor="let department of departments"
                    [value]="department.id"
                  >
                    {{ department.title }}
                  </option>
                </select>
                <div
                  *ngIf="
                    employeeForm.get('department_id')?.invalid &&
                    employeeForm.get('department_id')?.touched
                  "
                  class="text-danger"
                >
                  Department is required.
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="designation_id">Designation ID:</label>
                <select
                  formControlName="designation_id"
                  class="form-control"
                  required
                >
                  <option value="" disabled selected>
                    Select a Designation
                  </option>
                  <option
                    *ngFor="let designation of designations"
                    [value]="designation.id"
                  >
                    {{ designation.title }}
                  </option>
                </select>
                <div
                  *ngIf="
                    employeeForm.get('designation_id')?.invalid &&
                    employeeForm.get('designation_id')?.touched
                  "
                  class="text-danger"
                >
                  Designation is required.
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="category_id">Category ID:</label>
                <select
                  formControlName="category_id"
                  class="form-control"
                  required
                >
                  <option value="" disabled selected>Select a Category</option>
                  <option
                    *ngFor="let category of categories"
                    [value]="category.id"
                  >
                    {{ category.title }}
                  </option>
                </select>
                <div
                  *ngIf="
                    employeeForm.get('category_id')?.invalid &&
                    employeeForm.get('category_id')?.touched
                  "
                  class="text-danger"
                >
                  Category is required.
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="name">Name:</label>
                <input
                  formControlName="name"
                  type="text"
                  class="form-control"
                  id="name"
                  placeholder="Enter Name"
                  required
                />
                <div
                  *ngIf="
                    employeeForm.get('name')?.invalid &&
                    employeeForm.get('name')?.touched
                  "
                  class="text-danger"
                >
                  Name is required.
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="father_name">Father Name:</label>
                <input
                  formControlName="father_name"
                  type="text"
                  class="form-control"
                  id="father_name"
                  placeholder="Enter Father's Name"
                  required
                />
                <div
                  *ngIf="
                    employeeForm.get('father_name')?.invalid &&
                    employeeForm.get('father_name')?.touched
                  "
                  class="text-danger"
                >
                  Father Name is required.
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="gender">Gender:</label>
                <select formControlName="gender" class="form-control" required>
                  <option value="" disabled selected>Select Gender</option>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                  <option value="other">Other</option>
                </select>
                <div
                  *ngIf="
                    employeeForm.get('gender')?.invalid &&
                    employeeForm.get('gender')?.touched
                  "
                  class="text-danger"
                >
                  Gender is required.
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="dob">Date of Birth:</label>
                <input
                  formControlName="dob"
                  type="date"
                  class="form-control"
                  id="dob"
                  required
                />
                <div
                  *ngIf="
                    employeeForm.get('dob')?.invalid &&
                    employeeForm.get('dob')?.touched
                  "
                  class="text-danger"
                >
                  Date of Birth is required.
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="blood_group">Blood Group:</label>
                <select
                  formControlName="blood_group"
                  class="form-control"
                  id="blood_group"
                  required
                >
                  <option value="" disabled selected>Select Blood Group</option>
                  <option value="A+">A+</option>
                  <option value="A-">A-</option>
                  <option value="B+">B+</option>
                  <option value="B-">B-</option>
                  <option value="AB+">AB+</option>
                  <option value="AB-">AB-</option>
                  <option value="O+">O+</option>
                  <option value="O-">O-</option>
                </select>
                <div
                  *ngIf="
                    employeeForm.get('blood_group')?.invalid &&
                    employeeForm.get('blood_group')?.touched
                  "
                  class="text-danger"
                >
                  Blood Group is required.
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="phone">Phone:</label>
                <input
                  formControlName="phone"
                  type="tel"
                  class="form-control"
                  id="phone"
                  placeholder="Enter Phone Number"
                  required
                />
                <div
                  *ngIf="
                    employeeForm.get('phone')?.invalid &&
                    employeeForm.get('phone')?.touched
                  "
                  class="text-danger"
                >
                  Valid phone number is required. Format is (+923429873099)
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="email">Email:</label>
                <input
                  formControlName="email"
                  type="email"
                  class="form-control"
                  id="email"
                  placeholder="Enter Email"
                  required
                />
                <div
                  *ngIf="
                    employeeForm.get('email')?.invalid &&
                    employeeForm.get('email')?.touched
                  "
                  class="text-danger"
                >
                  Valid email is required.
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="joining_date">Joining Date:</label>
                <input
                  formControlName="joining_date"
                  type="date"
                  class="form-control"
                  id="joining_date"
                  required
                />
                <div
                  *ngIf="
                    employeeForm.get('joining_date')?.invalid &&
                    employeeForm.get('joining_date')?.touched
                  "
                  class="text-danger"
                >
                  Joining Date is required.
                </div>
              </div>
            </div>
            <div class="form-group col-md-6">
              <label for="address">Address:</label>
              <textarea
                formControlName="address"
                class="form-control"
                id="address"
                rows="1"
                placeholder="Enter Address"
                required
              ></textarea>
              <div
                *ngIf="
                  employeeForm.get('address')?.invalid &&
                  employeeForm.get('address')?.touched
                "
                class="text-danger"
              >
                Address is required.
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12 d-flex">
              <div style="padding-left: 0px" class="form-group col-md-6">
                <label for="image">Profile Image:</label>
                <div class="custom-file">
                  <input
                    type="file"
                    formControlName="image"
                    id="image"
                    (change)="onFileSelected($event)"
                    accept="image/*"
                  />
                  <label class="custom-file-label" for="image"
                    >Choose Image</label
                  >
                </div>
                <div
                  *ngIf="
                    employeeForm.get('image')?.invalid &&
                    employeeForm.get('image')?.touched
                  "
                  class="text-danger"
                >
                  Profile image is required.
                </div>
              </div>
              <div class="col-md-6">
                <div
                  class="row d-flex justify-content-center align-content-center mt-3"
                  *ngIf="imageURL"
                >
                  <img
                    style="
                      height: 180px;
                      width: 150px;
                      border: solid rgb(228, 228, 228);
                      border-radius: 10%;
                    "
                    [src]="imageURL"
                    alt="Selected Image"
                  />
                </div>
              </div>
            </div>
          </div>

          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="employeeForm.invalid"
          >
            {{ forUpdate ? "Update" : "Submit" }}
          </button>
        </form>
      </ng-template>
    </div>
  </div>
</div>
